<div class="container my-5">
  <h2 class="text-center mb-4">Configurar Sala</h2>

  @if (room(); as room) {
    <!-- Room Settings -->
    <div class="card mb-4 p-4 shadow-sm">
      <div class="mb-3">
        <label for="room-name" class="form-label">Nome da Sala</label>
        <input name="room-name" [(ngModel)]="room.name" class="form-control" />
      </div>

      <div class="mb-3 d-flex align-items-center justify-content-between">
        <div>
          <label for="privacy" class="form-label d-block">Privacidade</label>
          <button name="privacy" class="btn btn-outline-secondary" (click)="togglePrivacy()">
            {{ room.isPublic }}
          </button>
        </div>

        @if (!room.isPublic) {
          <div>
            <button class="btn btn-outline-primary" (click)="copyInviteLink()">
              <i class="bi bi-link-45deg"></i> Copiar link de convite
            </button>
          </div>
        }
      </div>

      <div class="row">
        <div class="col-md-6 mb-3">
          <label for="winning-rounds" class="form-label">Rondas para Vencer</label>
          <input
            name="winning-rounds"
            type="number"
            [(ngModel)]="room.winningRounds"
            class="form-control"
            min="1"
            [disabled]="true"
          />
        </div>
        <div class="col-md-6 mb-3">
          <label for="max-players" class="form-label">MÃ¡ximo de Jogadores</label>
          <input
            name="max-players"
            type="number"
            [(ngModel)]="room.maxPlayers"
            class="form-control"
            min="3"
            [disabled]="true"
          />
        </div>
      </div>
    </div>

    <!-- Players Section -->
    <div class="card p-4 shadow-sm mb-4">
      <h4 class="mb-3">Jogadores ({{ players.length }}/{{ room.maxPlayers }})</h4>

      <ul class="list-group">
        @for (player of players; track $index) {
          <li class="list-group-item d-flex justify-content-between align-items-center">
            <div>
              <strong>{{ player.name }}</strong>

              @if (player.isHost) {
                <span class="text-warning ms-2">ðŸ‘‘ Host</span>
              }
            </div>

            <div>
              <span
                class="badge"
                [ngClass]="{
                  'bg-success': player.status === 'READY',
                  'bg-secondary': player.status === 'WAITING',
                }"
                (click)="toggleStatus(player)"
                style="cursor: pointer"
              >
                {{ player.status === 'READY' ? 'Pronto' : 'Ã€ Espera' }}
              </span>
            </div>
          </li>
        }
      </ul>

      <div class="mt-3 text-center text-muted">{{ readyCount }}/{{ players.length }} prontos</div>
    </div>

    <!-- Action Buttons -->
    <div class="text-center">
      <button class="btn btn-success btn-lg me-3" (click)="startGame()">Iniciar Jogo</button>
      <a routerLink="/" class="btn btn-outline-secondary btn-lg">Voltar</a>
    </div>
  } @else {
    <p class="text-center text-muted">Loading...</p>
  }
</div>
